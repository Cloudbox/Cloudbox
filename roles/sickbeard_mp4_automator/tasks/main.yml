#########################################################################
# Title:         Cloudbox: sickbeard_mp4_automator Role                 #
# Author(s):     L3uddz, andrewkhunn                                    #
# URL:           https://github.com/cloudbox/cloudbox                   #
# --                                                                    #
#         Part of the Cloudbox project: https://cloudbox.rocks          #
#########################################################################
#                   GNU General Public License v3.0                     #
#########################################################################
---
- name: Create sickbeard_mp4_automator directories
  file: "path={{item}} state=directory mode=0775 owner={{user}} group={{user}} recurse=yes"
  with_items:
    - /opt/scripts/sickbeard_mp4_automator

- name: Clone sickbeard_mp4_automator
  git:
    repo: https://github.com/mdhiggins/sickbeard_mp4_automator
    dest: /opt/scripts/sickbeard_mp4_automator
    version: master
    force: yes

- name: Import sample config
  template:
    src: autoProcess.ini.sample
    dest: /opt/scripts/sickbeard_mp4_automator/autoProcess.ini.sample
    force: yes

- name: Import sickbeard_plex_autoscan
  template:
    src: sickbeard_plex_autoscan.py
    dest: /opt/scripts/sickbeard_mp4_automator/post_process/sickbeard_plex_autoscan.py
    force: no

- name: Delete post_process extras
  file:
    path: "{{item}}"
    state: absent
  with_items:
    - /opt/scripts/sickbeard_mp4_automator/post_process/iTunes.py
    - /opt/scripts/sickbeard_mp4_automator/post_process/sample.bat
    - /opt/scripts/sickbeard_mp4_automator/post_process/sample.py
    - /opt/scripts/sickbeard_mp4_automator/post_process/resources/add_to_iTunes.scpt
    - /opt/scripts/sickbeard_mp4_automator/post_process/resources/iTunes.bat

- name: Set directory permissions
  file: "path=/opt/scripts/sickbeard_mp4_automator state=directory owner={{user}} group={{user}} recurse=yes"

